{
  "name": "logcica product import from batra",
  "nodes": [
    {
      "parameters": {},
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "typeVersion": 1,
      "position": [
        240,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "const product = {\n    \"gtin\": \"00454000000001\",\n    \"gpcCategoryCode\": \"10005795\",\n    \"countryOfOrigin\": \"BEL\",\n    \"percentageOfAlcoholByVolume\": \"\",\n    \"netContent\": [\n        {\n            \"measurementUnitCode\": \"GRM\",\n            \"content\": \"200\"\n        },\n        {\n            \"measurementUnitCode\": \"MGM\",\n            \"content\": \"180\"\n        }\n    ],\n    \"productName\": [\n        {\n            \"language\": \"nl\",\n            \"value\": \"la bonne choucroute de chez nous\"\n        },\n        {\n            \"language\": \"fr\",\n            \"value\": \"les bons escargot bavant\"\n        },\n        {\n            \"language\": \"de\",\n            \"value\": \"und \"\n        }\n    ],\n    \"regulatedProductName\": [\n        {\n            \"language\": \"fr\",\n            \"value\": \"chouc\"\n        },\n        {\n            \"language\": \"en\",\n            \"value\": \"Shoetrout\"\n        }\n    ],\n    \"ingredient\": [\n        {\n            \"ingredientGtin\": \"NO GTIN\",\n            \"ingredientContentPercentage\": \"80\",\n            \"ingredientName\": \"choucroute\",\n            \"ingredientSequence\": 0\n        },\n        {\n            \"ingredientGtin\": \"NO GTIN\",\n            \"ingredientContentPercentage\": \"20\",\n            \"ingredientName\": \"Cochonnailles\",\n            \"ingredientSequence\": 1\n        }\n    ],\n    \"ingredientStatement\": [\n        {\n            \"language\": \"fr\",\n            \"value\": \"<p>Choucroute(80%); Cochonnaille(20%)</p>\"\n        }\n    ],\n    \"hasAllergen\": [\n        {\n            \"allergenLevelOfContainmentCode\": \"CONTAINS\",\n            \"allergenType\": \"AW\"\n        },\n        {\n            \"allergenLevelOfContainmentCode\": \"MAY_CONTAIN\",\n            \"allergenType\": \"UM\"\n        }\n    ],\n    \"consumerStorageInstructions\": [\n        {\n            \"language\": \"fr\",\n            \"value\": \"<p>à conserver à moins dix mille <b><font size=\\\"7\\\">degré</font></b></p>\"\n        }\n    ],\n    \"consumerUsageInstructions\": [\n        {\n            \"language\": \"fr\",\n            \"value\": \"<p>tarlalala</p>\"\n        }\n    ],\n    \"nutritionalInformation\": {\n        \"nutrientHeaders\": [\n            {\n                \"nutrientBasisQuantityTypeCode\": \"BY_MEASURE\",\n                \"preparationStateCode\": \"UNPREPARED\",\n                \"nutrientBasisQuantity\": {\n                    \"measurementUnitCode\": \"GRM\",\n                    \"value\": \"100\"\n                },\n                \"dailyValueIntakeReference\": [\n                    {\n                        \"language\": \"fr\",\n                        \"value\": \"Basé sur le document du SPF Economie de Belgique pour 2000kcal/jour\"\n                    }\n                ],\n                \"servingSize\": {},\n                \"servingSizeDescription\": [\n                    {\n                        \"language\": \"fr\",\n                        \"value\": \"Quantité de la portion non communiquée\"\n                    }\n                ],\n                \"nutrientDetail\": [\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"ENER-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"KJO\",\n                            \"value\": \"330\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"ENER-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"E14\",\n                            \"value\": \"77.9\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"PRO-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"16.1\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"PRO-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"16.1\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"CHOAVL\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"1.29\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"FAT\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.92\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"SUGAR-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"FRUFB\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \" 0.2\"\n                        },\n                        \"measurementPrecisionCode\": \"LESS_THAN\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"GALFB\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"UNSPECIFIED\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"GLUS\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \" 0.2\"\n                        },\n                        \"measurementPrecisionCode\": \"LESS_THAN\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"LACS\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \" 0.2\"\n                        },\n                        \"measurementPrecisionCode\": \"LESS_THAN\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"STARCH\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"FIBTG\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"POLYL\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"ALC\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"OA\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"FASAT\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.19\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"FAMSCIS\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.13\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"FAPUCIS\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.26\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"F16D0\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.11\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"F18D2CN6\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.12\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"F18D3N3\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.016\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"F20D4\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"UNSPECIFIED\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"F20D5N3\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.12\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"F22D6N3\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"CHOL-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"57.5\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"NACL\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"GRM\",\n                            \"value\": \"0.35\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"CA\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"90\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"CLD\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"UNSPECIFIED\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"CU\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"2.8\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"FE\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"2.6\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"ID\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \"6\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"MG\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"48.3\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"MN\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"1.2\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"P\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"157\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"K\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"35\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"SE\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"UNSPECIFIED\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"NA\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"138\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"ZN\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"1.17\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITA\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \"30\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITA-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITD-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \" 0.5\"\n                        },\n                        \"measurementPrecisionCode\": \"LESS_THAN\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITE-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"5\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITK1\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \"0.1\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITK2\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"UNSPECIFIED\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITC-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"15\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"THIA\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"0.02\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"RIBF\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"0.12\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"NIA\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"1.7\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"PANTAC\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"0\"\n                        },\n                        \"measurementPrecisionCode\": \"UNSPECIFIED\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITB6-\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MGM\",\n                            \"value\": \"0.028\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"FOL\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \"8.5\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    },\n                    {\n                        \"dailyValueIntakePercent\": \"\",\n                        \"nutrientTypeCode\": \"VITB12\",\n                        \"quantityContained\": {\n                            \"measurementUnitCode\": \"MC\",\n                            \"value\": \"0.92\"\n                        },\n                        \"measurementPrecisionCode\": \"APPROXIMATELY\"\n                    }\n                ]\n            }\n        ]\n    }\n}\n\nreturn product;"
      },
      "name": "Product stub",
      "type": "n8n-nodes-base.functionItem",
      "typeVersion": 1,
      "position": [
        440,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "const language = \"fr\"\n\n// how to handle percentage of nutrient per serving, ....\n\nconst netContentWeight =  item.netContent.find(n => [\"GRM\",\"KGM\"].includes(n.measurementUnitCode))\n\nconst product = {\n  ids: [\n    \"https://batra.link/gtin/\" + item.gtin\n  ],\n  gtin: item.gtin,\n  name: item.productName.find(i => i.language = language).value,\n  regulatedName: item.regulatedProductName.find(i => i.language = language).value,\n  categories: [\n    {\n      code: item.gpcCategoryCode,\n      classification: {\n        key: \"gpc\"\n      }\n    }\n  ],\n  netWeight: {\n    value: parseFloat(netContentWeight.content),\n    unit: {\n      code: netContentWeight.measurementUnitCode\n    }\n  },\n  alcohol: {\n    quantity: {\n      percentage: parseFloat(item.percentageOfAlcoholByVolume)\n    }\n  },\n  countryOfOrigin: {\n    codeAlpha3: item.countryOfOrigin\n  },\n  ingredientList: item.ingredient.map(i => ({\n    ingredient: {\n      name: i.ingredientName,\n    },\n    sequence: i.ingredientSequence,\n    quantity: {\n      percentage: parseFloat(i.ingredientContentPercentage)\n    }\n  })),\n  ingredientListStatement: item.ingredientStatement.find(i => i.language = language).value,\n  allergenList: item.hasAllergen.map(i => ({\n    allergen: {\n      code: i.allergenType,\n    },\n    quantity: {\n      level: {\n        code: i.allergenLevelOfContainmentCode\n      }\n    }\n  })),\n  consumerUsageInstructions: [\n    item.consumerUsageInstructions.find(i => i.language = language).value\n  ],\n  consumerStorageInstructions: [\n    item.consumerStorageInstructions.find(i => i.language = language).value\n  ],\n  nutrientList: item.nutritionalInformation.nutrientHeaders.find(h => \n      h.nutrientBasisQuantityTypeCode == \"BY_MEASURE\" &&\n      h.preparationStateCode == \"UNPREPARED\" )\n    .nutrientDetail.map(n => ({\n    nutrient: {\n      code: n.nutrientTypeCode,\n    },\n    dailyValueIntake: {\n      percentage: parseFloat(n.dailyValueIntakePercent)\n    },\n    quantity: {\n      value: parseFloat(n.quantityContained.value),\n      unit: {\n        code: n.quantityContained.measurementUnitCode\n      },\n      precision: {\n        code: n.measurementPrecisionCode\n      }\n    }\n  }))\n}\n\nreturn product;"
      },
      "name": "Map product",
      "type": "n8n-nodes-base.functionItem",
      "typeVersion": 1,
      "position": [
        620,
        300
      ]
    },
    {
      "parameters": {
        "functionCode": "const product = item\n\nconst test = {\n  description: \n`\n<p>\n  <a href=\"https://www.batra.link/productFull.html?gtin=${ product.gtin }\">\n    Fiche produit sur OpenBatra\n  </a>\n</p>\n<p>\n  <u>Pays d'origine:</u> ${product.countryOfOrigin.codeAlpha3}\n  <br/><u>Poids net:</u> ${product.netWeight.value} ${product.netWeight.unit.code}\n  ${product.alcohol ? `\n    <br/><u>Pourcentage d'alcool:</u> ${product.alcohol.quantity.percentage}%\n  ` : \"\"}\n</p>\n\n<p>\n<strong>Ingrédients</strong>\n</p>\n\n</p>\n${product.ingredientListStatement ? `\n  ${product.ingredientListStatement }\n` : `\n${product.ingredientList.map(i => \n  `${i.ingredient.name} (${i.quantity.percentage}%)`)\n.join(\", \")}\n`\n}\n</p>\n\n<p>\n<strong>Allergènes</strong>\n</p>\n\n<p>\n${product.allergenList.map(i => \n  `${i.quantity.level.code} ${i.allergen.code}`)\n.join(\"<br/>\")}\n</p>\n\n<p>\n  <strong>Nutrition</strong>\n</p>\n\n<p>\n${product.nutrientList.map(i => \n  `${i.nutrient.code}: ${i.quantity.value} ${i.quantity.unit.code}`)\n.join(\"<br>\")}\n</p>\n\n\n${product.consumerUsageInstructions ? `\n  <p>\n    <strong>Instructions d'utilisation</strong>\n  </p>\n\n  ${product.consumerUsageInstructions }\n\n` : \"\"}\n\n${product.consumerStorageInstructions ? `\n  <p>\n    <strong>Instructions de stockage</strong>\n  </p>\n\n  ${product.consumerStorageInstructions }\n\n` : \"\"}\n`\n}\n\nreturn test;"
      },
      "name": "eCommerceDescription",
      "type": "n8n-nodes-base.functionItem",
      "typeVersion": 1,
      "position": [
        800,
        300
      ]
    }
  ],
  "connections": {
    "Start": {
      "main": [
        [
          {
            "node": "Product stub",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Product stub": {
      "main": [
        [
          {
            "node": "Map product",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Map product": {
      "main": [
        [
          {
            "node": "eCommerceDescription",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {},
  "id": 17
}